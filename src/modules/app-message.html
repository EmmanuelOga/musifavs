<app-message>
  {message}

  <div class='app-message-dismiss'>
    <a href='javascript:void(0)' onclick={dismiss}>Dismiss</a>
  </div>

  <script>
    var c, disp = require('../lib/dispatcher'), tr = disp.trigger

    this.on('unmount', function() { c.destroy() })

    this.on('mount', function() {
      c = disp.context()

      c.on('module:message:do:show', function(text) {
        this.show(text)
        this.update()
      }.bind(this))

      c.on('module:message:do:dismiss', function(text) {
        this.dismiss()
        this.update()
      }.bind(this))
    })

    show(text) {
      this.message = text
      this.root.classList.remove('app-hidden')
    }

    dismiss(ev) {
      this.message = ''
      this.root.classList.add('app-hidden')
    }

    this.on('mount', function() {
      this.dismiss()
    })
  </script>
</app-message>
