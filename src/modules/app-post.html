<app-post>
  <div></div>

  <script>
    var Post = require('../app/post')
    var Mounter = require('../lib/mounter')

    this.don = opts.don
    this.dtr = opts.dtr

    console.log(this)
    console.log(opts)

    this.don('module:post-show:do:edit', function(post){
      if (this.post.equals(post)) {
        this.edit()
      }
    }.bind(this))

    this.don('module:post-form:did:cancel', function(post){
      if (!post.unstored() && this.post.equals(post)) {
        this.show()
      }
    }.bind(this))

    var m = new Mounter()

    show(data) {
      var n = this.root.firstElementChild
      if (n) {
        m.display(n, 'app-post-show', {post: this.post})
      }
    }

    edit(data) {
      var n = this.root.firstElementChild
      if (n) {
        m.display(n, 'app-post-form', {post: this.post})
      }
    }

    this.post = new Post(opts.post)

    this.don('mount', function() {
      if (this.post.stored) {
        this.show()
      } else {
        this.edit()
      }
    })

  </script>
</app-post>
